% sensor selection error surface
% Zhen Song
%
% Log
% 1/17/2007: start
% 1/19/2007: 2nd round data

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Data input
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% est{i,j}=[
%  x,y,0; <- manual measurement
%  x,y,r; <- 1st estimation
%  x,y,r; <- 2nd estimation. 10 sets of 2nd estimations
%]
% The unit is inch

est=cell(3,7);

est{1,1}=[
    3.8, 3, 0 
    4.0474831836304,3.98640937729381,0.530539616068237
    3.69030219368631,4.53084046791177,0.245608597232329
    3.79360998078517,4.44047335771038,0.247284311837911
    3.79621500159606,4.43812979567396,0.247333701041882
    3.79900725974776,4.43551236073322,0.247378113526514
    3.80174302218333,4.43300988735921,0.247426551668037
    3.80420788178024,4.43078235024581,0.247473424908412
    3.80711507842732,4.42857523620138,0.2475153769021
    3.8097045499778,4.42617335224803,0.247561259612977
    3.81176453716081,4.42382284651583,0.24760574512124
    3.81405626047611,4.42173848606945,0.247644785685762
];

est{1,2}=[
    7.6, 3.3, 0
    8.04844648870563,4.10461796931969,0.474034178884049
    7.78988705044351,3.26877842057838,0.218798813393424
    7.85778583557264,3.70231012279228,0.221532654441194
    7.86192679005886,3.72254326525508,0.221677350012992
    7.86268122779319,3.72599101036754,0.221704707275966
    7.86299442102457,3.72896057293481,0.221729475943818
    7.86372897760968,3.7322146762133,0.221751784546935
    7.86424004209608,3.73548455575158,0.221775182307836
    7.86498119492832,3.73878126829728,0.221799368202466
    7.86546919166884,3.741852517379,0.221823167916907
    7.86618793195867,3.74495644064239,0.221845942306571
];

est{1,3}=[
    12, 2.8, 0
    12.5301623430214,3.4021758557392,0.528036383294451
    12.5294420397135,3.40524153336293,0.242459389292195
    12.7900441996901,3.0685666537424,0.244938500366456
    12.7928760010253,3.06620515984053,0.24495991350521
    12.8010155606284,3.04736388574673,0.245080711854237
    12.8038350664367,3.04584990716162,0.245104828795585
    12.8061397485558,3.04342702829233,0.245116957274766
    12.8078170282549,3.04069913993192,0.245134405943397
    12.8107497109872,3.03951915959153,0.245153243198329
    12.8129271275762,3.03667948673614,0.24516325582619
    12.8152575286711,3.0351250374991,0.245183184291676
];

est{1,4}=[
    15.3, 3.1, 0
    15.8323772861596,3.65729018727796,0.476469782144612
    15.7879022162631,4.68445564682164,0.226131498088571
    15.6094905438954,4.34808463598548,0.226633922743073
    15.5944614710543,4.32868423969731,0.226655668424468
    15.5922960059422,4.32588507176634,0.226658829730532
    15.5899486989545,4.32304366225173,0.226662274784185
    15.587849219258,4.32040412899407,0.22666504665521
    15.5853176349295,4.31757584665639,0.226668107160708
    15.5830726106713,4.31496905726211,0.226669969841257
    15.581110799512,4.31218027172983,0.226672212266429
    15.5791772636353,4.30947082400796,0.226676968931825
];

est{1,5}=[
    19.2, 3.2, 0
    20.2149398942565,3.92034236110996,0.497836240088391
    19.8041844512562,4.44360025388118,0.247456076130034
    19.8137229503216,4.42591174170551,0.247599608866044
    19.8352920332063,4.40095468039268,0.24800671934566
    19.8380717408332,4.3983204475248,0.248054573553278
    19.84124132214,4.39623280729016,0.248102097784305
    19.8441247815937,4.3939165385831,0.248148654855953
    19.8464684242864,4.39164588066321,0.248194386207589
    19.8475911944007,4.38871336871884,0.248234695550386
    19.8496789947044,4.38630470486163,0.248269122587239
    19.8514765997059,4.38371663964075,0.248308105433175
];

est{1,6}=[
    23,3.3, 0
    23.4269705135168,4.12908722018588,0.474318308701361
    24.1851374508688,3.47794833112922,0.262776502012932
    24.2056483211575,3.9096396046454,0.262622132598746
    24.2264813432486,3.94906325937053,0.263038148207259
    24.2366940949596,3.96696274390946,0.263267420558916
    24.2384594543067,3.96973520112174,0.263312607391327
    24.2399539702703,3.97230541432262,0.263353172150807
    24.2401667566297,3.97419000623648,0.263387378212243
    24.2397707185921,3.9753254663463,0.26339083429375
    24.2389034355644,3.97659349865715,0.26338005871795
    24.2382601756784,3.97792301541945,0.263357603249006
];

est{1,7}=[
    26.8, 3.6, 0
    27.5725386207448,4.80468523153953,0.526022594967061
    27.5733024278611,4.66731049947225,0.245229750431927
    27.5738603104731,4.66361680980554,0.24517038515931
    27.4633925778482,5.07147056596402,0.25262593132801
    27.4618030342764,5.07487018164453,0.252701019037374
    27.4601343301208,5.07826269715765,0.25277433985669
    27.4583153821469,5.08130138199575,0.252847446347764
    27.4568222667089,5.0840248556857,0.252912088257293
    27.4553609680044,5.08668047409301,0.252970565270152
    27.4778290153921,5.14803823223532,0.258296660822031
    27.4759928106581,5.15566491531472,0.25853433991981
];

est{2,1}=[
    3.8, 7.6, 0
    5.19247472077239,8.38626785551865,0.49245825836639
    5.43855852814086,6.49575163166598,0.238726884130604
    5.5300084799918,7.10290308856285,0.24328769866985
    5.52910155290043,7.10647917238645,0.243327004516333
    5.52867208536207,7.1103902502845,0.243364510889071
    5.52815725289167,7.11405857387911,0.243402383757097
    5.52716529095717,7.11732101151381,0.243438544988974
    5.52659728528346,7.12070011516655,0.243473726119788
    5.52561928174833,7.12390084768421,0.243507584298037
    5.52431571702406,7.12715308779106,0.243542151471669
    5.52338333241307,7.1303280332901,0.243579043105776
];

est{2,2}=[
    7, 6.9, 0
    7.10351390415587,8.32211001953104,0.464904533379217
    7.09131262087992,7.2554386028169,0.23626064828166
    7.04588829045246,7.71837183698774,0.239454026071859
    7.04518147964838,7.72218286752515,0.239476836274018
    7.04446875842448,7.72594293632048,0.239497629139189
    7.0433738340172,7.7419728070872,0.239575090596243
    7.04253675693438,7.74545167873637,0.239593382648254
    7.04124341296261,7.7487642276587,0.239611972979637
    7.04031124217408,7.75228932892047,0.239631773136892
    7.03906564388669,7.75552739139764,0.239650603090459
    7.03768523759128,7.75860358114261,0.23966950681079
];

est{2,3}=[
    11.2, 7.3, 0
    12.7244546498609,7.91581685936649,0.474274559157398
    12.5944366152738,7.85704092796102,0.231102058331098
    12.591537434999,7.85563722171299,0.23106004344745
    12.5886320314792,7.85404592076225,0.231025323588074
    12.585908215043,7.85271958407035,0.23098980925528
    12.5827664259719,7.85118631665943,0.230957258695373
    12.5797194670246,7.84969279228447,0.230919757107458
    12.5772644430512,7.84847946835278,0.230883419758822
    12.5749837136277,7.84706766596286,0.23085414324467
    12.5726716650092,7.845922008459,0.230825809168539
    12.5708351814446,7.84482436471876,0.230798297213902
];

est{2,4}=[
    15.5, 7.8, 0
    14.4356781955664,9.13675562635047,0.470559229881083
    14.1454778673083,9.01483418485509,0.248127537728326
    14.143358809858,9.01154854031136,0.248074608122404
    14.368104182344,8.95601449695197,0.249753138574824
    14.3718628056138,8.95582478389369,0.249794249846502
    14.3749876242079,8.95559282408547,0.24983990686404
    14.3780523281553,8.95513520343895,0.249877065358886
    14.3808979800278,8.95500626963005,0.249910451350276
    14.3840088741955,8.95469284110166,0.249945833614049
    14.386980268267,8.9544311250481,0.249982260932188
    14.3898950030945,8.95454994472526,0.250017790346692
];

est{2,5}=[
    19.5, 7.5, 0
    20.8715408008781,7.88007813823719,0.480274061779725
    19.7766467180037,7.90031835501856,0.230224568977455
    19.7740648486673,7.90056936338291,0.230205511946842
    20.2711164479792,7.59689858755187,0.23118118443546
    20.2740859061849,7.59465458271047,0.231188390585385
    20.2764833105639,7.59219954845736,0.231197205167541
    20.2780255479161,7.58970730319232,0.231200907008055
    20.2795269056123,7.58726615144305,0.231198415148742
    20.2814949114178,7.5846904969913,0.231195982858905
    20.2836921022796,7.58243955755335,0.231196234462091
    20.2859220869828,7.58044548217516,0.231199936578724
];

est{2,6}=[
    23.5, 7, 0
    23.2291287259428,8.52600994778599,0.464769169249906
    24.1919734328888,6.19244286700353,0.234933041834163
    24.2185858725472,6.49483621453919,0.234684813943579
    24.2202262258969,6.49799063581697,0.234688540982829
    24.2218764542288,6.50078961639374,0.234694268612303
    24.2232078501157,6.50397743826536,0.234700348734883
    24.2247957811767,6.50720445733702,0.234704580980775
    24.2261369592064,6.51034059285691,0.234710095874418
    24.2274975456499,6.51289674726909,0.234714484578506
    24.2295032681051,6.51455788136657,0.234719417957237
    24.2314938776745,6.51638141608923,0.234728222249876
];

est{2,7}=[
    27.3, 8, 0
    28.5928281003494,8.51380349863577,0.46953183590475
    28.7191276728031,7.26318106148668,0.219098408199878
    28.2782765639044,7.64465664621348,0.220281684340674
    28.2761619143566,7.64781956109518,0.220293441637172
    28.2745972443569,7.65069776320583,0.220304983306441
    28.2726018200144,7.65376146955409,0.220314151541114
    28.2706706587754,7.65677468057445,0.220325323920195
    28.2688017692495,7.65973831911525,0.220336289276854
    28.2669932189114,7.66265328743853,0.220347050895101
    28.2648637221324,7.66555046382949,0.220357612057879
    28.2632847975459,7.66816781891551,0.22036953845711
];

est{3,1}=[
    3.5, 11.7, 0
    3.09687762311607,12.5689839394288,0.555780502598974
    3.92359954309961,12.1001918512246,0.238470752046229
    3.94391559619304,12.0982973141513,0.238324441753265
    3.98799444479162,12.1067602577344,0.238054228823887
    4.02573235673257,12.120021143127,0.237853616152455
    4.06264798146971,12.1379265487523,0.237685400797833
    4.10684749231686,12.1647741912006,0.237518396400454
    4.1360872669641,12.1845313243231,0.237425067643203
    4.20268688562826,12.2259465660745,0.237231572809417
    4.417049431429,12.3516375693853,0.236817116445147
    4.41595406306127,12.3503609142533,0.236811748000578
];

est{3,2}=[
    8, 11.2, 0
    8.48182696704214,12.3442172791527,0.494885545009503
    8.39393545173675,12.3407335754648,0.263934849712607
    8.39008436610658,12.3407959058925,0.263912542174231
    8.37423391186283,12.340764581803,0.263822614654134
    8.37042123269111,12.3411751518556,0.263799878451527
    8.36677627616588,12.3413320744812,0.263772673445137
    8.3631984259023,12.3426464193286,0.263749387885431
    8.35969718737714,12.3435065379197,0.263712345331416
    8.35627277542459,12.3439369450584,0.263681158070238
    8.35262690955769,12.3438715710763,0.26365551464843
    8.34928357483886,12.3443114512877,0.263634400596631
];

est{3,3}=[
    12.1, 10.8, 0
    12.1545258924819,12.14087220982,0.51969478800259
    12.4587856607152,11.9086271237921,0.241023229865354
    13.086612409275,12.099189461058,0.250191524091398
    13.0164085332725,12.3474567130655,0.248734125918859
    13.0628151138377,12.3248090794699,0.24946032031902
    12.9751933397787,12.5444239460777,0.247800249333395
    13.2274154863334,12.3665948980713,0.252343481984132
    13.188742043957,12.5074728986228,0.251341392946569
    13.1565165908766,12.5726132698614,0.250615013478188
    13.155106399523,12.5746932480242,0.250576550664049
    13.1561131076997,12.5748755752769,0.250546945157326
];

est{3,4}=[
    15.2, 11.6, 0
    14.5526142604682,12.2590462449459,0.482024832778939
    13.9351282158724,12.2989834503444,0.284945766294924
    14.142758115211,12.2412202647842,0.298551486143719
    14.146009875663,12.2403092631596,0.298838121625628
    14.149216411208,12.2394253841412,0.299083219504926
    14.1520822111325,12.2392461100974,0.299325613820961
    14.1549064064729,12.2390644044544,0.299540326352619
    14.1578374380442,12.2385410682676,0.299752537720442
    14.1607271037254,12.2380296811226,0.2999748162573
    14.1636071971757,12.2379378730859,0.30019456715541
    14.1665927789055,12.237500079389,0.300412446316843
];

est{3,5}=[
    19.6, 11.2, 0
    20.1759974569403,11.8348526478546,0.525240604622037
    20.2625320853757,11.8436422478968,0.239340098732339
    20.2663230715709,11.8435260899923,0.2393690472123
    20.270001607495,11.8433639373404,0.239397353851925
    20.2738216285464,11.8433836763175,0.239425031959896
    20.0582650101058,12.0042005207837,0.25282291302391
    20.0593964397805,12.0028386822792,0.252843778237171
    20.0605120159667,12.0015030904996,0.252860489901919
    20.0616118527779,12.0001931721269,0.252876896153131
    20.0629365807236,11.9991452437586,0.25289300271723
    20.0639969143623,11.9978689664111,0.252908925627841
];

est{3,6}=[
    23.8, 11.5, 0
    25.4209886143985,12.2126252022009,0.500049229713879
    25.4333491965396,12.0772573192592,0.2474726875701
    25.4602379287259,12.2715976242901,0.24656359758152
    25.4609098737801,12.275270820689,0.24654718352942
    25.4613058889895,12.2786174745469,0.246530483425011
    25.4616768785831,12.2817953217742,0.246516357548666
    25.4619037089963,12.284459772763,0.246503020026926
    25.4620899920182,12.2877058887874,0.246492272070595
    25.4622770874241,12.2900742340604,0.246479644524678
    25.4625684007942,12.292676863969,0.246470221876805
    25.4626979111883,12.2955108497618,0.246459498137656
];

est{3,7}=[
    26.4, 11.5, 0
    27.3900942961187,11.601454487046,0.52302180705273
    27.3883920167765,11.6024585113237,0.244532340543695
    26.8275215897316,11.4284901254502,0.254476312425801
    26.8180378780527,11.4209831453314,0.254681941268781
    26.8071181328237,11.4159366048291,0.254906896641411
    26.8041412341345,11.4149053971816,0.254984741434298
    26.8009465493263,11.4130126194084,0.255051584540131
    26.7981575167954,11.4115767621728,0.255120500091348
    26.7957080954625,11.4099972140854,0.255181611407412
    26.793318451826,11.4084582394704,0.255234152693239
    26.7909871520897,11.4069588622595,0.255285495600224
];


SampRate=[
    84, 84, 0, 0, 0, 0, 84, 0, 0, 0, 0, 0, 0, 0, 0 %1,1
    0, 0, 0, 0, 0, 59, 117, 77, 0, 0, 0, 0, 0, 0, 0 %1,2
    0, 74, 125, 0, 0, 0, 0, 55, 0, 0, 0, 0, 0, 0, 0 %1,3
    0, 100, 121, 33, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 %1,4
    0, 0, 84, 84, 0, 0, 0, 0, 84, 0, 0, 0, 0, 0, 0 %1,5
    0, 0, 2, 0, 0, 0, 0, 125, 126, 0, 0, 0, 0, 0, 0 %1,6
    0, 0, 0, 19, 0, 0, 0, 0, 126, 109, 0, 0, 0, 0, 0 %1,7
    0, 0, 0, 0, 0, 84, 84, 0, 0, 0, 0, 84, 0, 0, 0 %2,1
    %0, 84, 0, 0, 0, 84, 84, 0, 0, 0, 0, 0, 0, 0, 0 %2,2
    0, 0, 0, 0, 0, 84, 84, 0, 0, 0, 0, 84, 0, 0, 0 %2,2
    %  0, 0, 0, 0, 0, 0, 84, 84, 0, 0, 0, 0, 84, 0, 0 % 2,3
    0, 0, 88, 0, 0, 0, 0, 121, 0, 0, 0, 0, 45, 0, 0 %2,3
    0, 0, 0, 0, 0, 0, 32, 114, 0, 0, 0, 0, 108, 0, 0 %2,4
    0, 0, 0, 100, 0, 0, 0, 0, 123, 0, 0, 0, 0, 31, 0 %2,5
    % 0, 0, 0, 106, 0, 0, 0, 35, 113, 0, 0, 0, 0, 0, 0 %2,6
    0, 0, 0, 0, 0, 0, 0, 84, 84, 0, 0, 0, 0, 84, 0 %2,6
    0, 0, 0, 0, 0, 0, 0, 0, 112, 0, 0, 0, 0, 67, 74 %2,7
    0, 0, 0, 0, 0, 88, 0, 0, 0, 0, 124, 41, 0, 0, 0 %3,1
    0, 0, 0, 0, 0, 0, 84, 0, 0, 0, 0, 84, 84, 0, 0 %3,2
    0, 0, 0, 0, 0, 0, 0, 93, 0, 0, 0, 34, 127, 0, 0 %3,3
    0, 0, 0, 0, 0, 0, 0, 123, 0, 0, 0, 0, 120, 11, 0 %3,4
    0, 0, 0, 0, 0, 0, 0, 44, 127, 0, 0, 0, 0, 83, 0 %3,5
    % 0, 0, 0, 0, 0, 0, 0, 84, 84, 0, 0, 0, 0, 84, 0 %3,6
    0, 0, 0, 0, 0, 0, 0, 0, 33, 0, 0, 0, 0, 116, 105 %3,6 
    0, 0, 0, 0, 0, 0, 0, 0, 126, 22, 0, 0, 0, 105, 0
];



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Computation
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
inch2cm=2.54;

Err1=zeros(3,7); % 1st est.
Err2=zeros(3,7); % 2nd est.
TapPos=zeros(3,7,2);% pos. measured by tape
xall=zeros(3,7);
yall=zeros(3,7);

xvar=linspace(0,32,320/5)*inch2cm; xratio=length(xvar)/(32*inch2cm);
yvar=linspace(0,16,160/5)*inch2cm; yratio=length(yvar)/(16*inch2cm);

Surf1=zeros(length(xvar),length(yvar));
Surf2=zeros(length(xvar),length(yvar));
for row=1:3
    for col=1:7
        est{row,col}=est{row,col}*inch2cm;
    end
end

for row=1:3
    for col=1:7
        TapPos(row,col,:)=est{row,col}(1,1:2);
        Err1(row,col)=norm(est{row,col}(2,1:2)-est{row,col}(1,1:2));
        dat2=est{row,col}(3:end,1:2);
        Err2(row,col)=norm(mean(dat2,1)-est{row,col}(1,1:2));
        
        Surf1(round(TapPos(row,col,1)*xratio), round(TapPos(row,col,2)*yratio)) = Err1(row,col);
        Surf2(round(TapPos(row,col,1)*xratio), round(TapPos(row,col,2)*yratio)) = Err2(row,col);   
        xall(row,col)=TapPos(row,col,1);
        yall(row,col)=TapPos(row,col,2);        
    end
end

% for row=1:length(xvar)
%     for col=1:length(yvar);
%         pos=[row/xratio, col/yratio];
%         Surf1(row,col)=interp2(xall,yall,Err1,pos(1), pos(2));
%         Surf2(row,col)=interp2(xall,yall,Err2,pos(1), pos(2));        
%     end
% end
Surf1=GRIDDATA(xall,yall,Err1, xvar, yvar','cubic');
Surf2=GRIDDATA(xall,yall,Err2, xvar, yvar','cubic');

% plot3(reshape(TapPos(:,:,1),1,21),...
%     reshape(TapPos(:,:,2),1,21),...
%     reshape(Err1(:,:),1,21),'*');
myview=[0 32 0 16 0 2.4]*inch2cm;


disp('unit: cm');
err1=mean(mean(Err1))
std1=std(reshape(Err1,1,21))
err2=mean(mean(Err2))
std2=std(reshape(Err2,1,21))

figure(1)
set(gcf,'Position',[30,80,1000,800]);
subplot(2,1,1);
surf(xvar,yvar,Surf1); hold on;
contour(xvar,yvar,Surf1);
axis(myview);campos([-20,-40,10]);
xlabel('x (cm)'); ylabel('y (cm)'); zlabel('error (cm)');
title('Positioning error of the 1st estimation.');


subplot(2,1,2);
h2=surf(xvar,yvar,Surf2); hold on;
% set(h2,'FaceAlpha',0.9,'FaceColor','red','FaceLighting','Phong');
contour(xvar,yvar,Surf2);
xlabel('x (cm)'); ylabel('y (cm)'); zlabel('error (cm)');
title('Positioning error of the 2nd estimation.');
axis(myview); campos([-20,-40,10]);

% print -deps2c SSHardwareErrorSurf.eps;
% saveas(gcf, 'SSHardwareErrorSurf','mfig');

hf2=figure(2)
set(hf2,'Position',[30,80,1000,1000]);
subplot(2,2,1);
surf(xvar,yvar,Surf1); hold on;
contour(xvar,yvar,Surf1);
axis(myview); axis equal;
campos([-20,-40,60]);
xlabel('x (cm)'); ylabel('y (cm)'); zlabel('error (cm)');
title('Positioning error of the 1st estimation.');

subplot(2,2,2);
surf(xvar,yvar,Surf2); hold on;
contour(xvar,yvar,Surf2);
xlabel('x (cm)'); ylabel('y (cm)'); zlabel('error (cm)');
title('Positioning error of the 2nd estimation.');
axis(myview); axis equal;
campos([-20,-40,60]);

subplot(2,2,3);
surf(xvar,yvar,Surf1); hold on;
contour(xvar,yvar,Surf1);
axis(myview); axis normal;
campos([-20,-40,40]);
xlabel('x (cm)'); ylabel('y (cm)'); zlabel('error (cm)');
title('Positioning error of the 1st estimation.');

subplot(2,2,4);
surf(xvar,yvar,Surf2); hold on;
contour(xvar,yvar,Surf2);
xlabel('x (cm)'); ylabel('y (cm)'); zlabel('error (cm)');
title('Positioning error of the 2nd estimation.');
axis(myview); axis normal;
campos([-20,-40,40]);

% print -deps2c SSHardwareErrorSurf4plots.eps;
% saveas(gcf, 'SSHardwareErrorSurf4plots','mfig');

hf=figure(3)
% subplot(1,2,1);
subplot(2,1,1);
Surf2over1=Surf2./Surf1;
surf(xvar,yvar,Surf2over1); hold on;
contour3(xvar,yvar,Surf2over1,5,'r')
contour(xvar,yvar,Surf2over1,5)
xx=[0 80 80 0]; yy=[0 0 40 40]; zz=[1 1 1 1];
h=patch(xx, yy, zz, 'g');
set(h, 'FaceAlpha',0.5, 'FaceColor','blue');
xlabel('x (cm)'); ylabel('y (cm)'); zlabel('radio ');
title('The ratio of 2nd estimation error over the 1st estimation error.');
myview2=[0 32 0 16 0 1.6/inch2cm]*inch2cm;
axis(myview2);
campos([-2,-40,4]); axis square;

% subplot(1,2,2);
subplot(2,1,2);
Surf2over1=Surf2./Surf1;
surf(xvar,yvar,Surf2over1); hold on;
contour3(xvar,yvar,Surf2over1,5,'r')
contour(xvar,yvar,Surf2over1,5)
xx=[0 80 80 0]; yy=[0 0 40 40]; zz=[1 1 1 1];
h=patch(xx, yy, zz, 'g');
set(h, 'FaceAlpha',0.5, 'FaceColor','blue');
xlabel('x (cm)'); ylabel('y (cm)'); zlabel('radio ');
title('The ratio of 2nd estimation error over the 1st estimation error.');
myview2=[0 32 0 16 0 1.6/inch2cm]*inch2cm;
axis(myview2); axis square;
campos([-2,-40,1]);
% set(hf,'Position',[10, 80, 1000,600]);
set(hf,'Position',[224 91 757 823]);
% print -deps2c SSHardwareRatioSurf.eps;
% saveas(gcf,'SSHardwareRatioSurf','fig');
% saveas(gcf,'SSHardwareRatioSurf','mfig');
% print -deps2c SSHardwareRatioSurfPortrait.eps;
% saveas(gcf,'SSHardwareRatioSurfPortrait','fig');
% saveas(gcf,'SSHardwareRatioSurfPortrait','mfig');


hf3=figure(4)
% set(hf3,'Position',[10, 80, 1000,800]);
aline=1:7; aline=aline'; aline=aline*0.1;
IndDat=zeros(21,2);
ItNum=1;
for row=1:3
    for col=1:7
        IndDat(ItNum,:)=[row, col];
        ItNum=ItNum+1;
    end
end

SenPosX=repmat([0:8:32]',3,1);
SenPosX=SenPosX*inch2cm;
SenPosY=[zeros(5,1); ones(5,1)*8; ones(5,1)*16];
SenPosY=SenPosY*inch2cm;


figure;
for cntX=[4:4:28]*inch2cm
    for cntY=[4:4:12]*inch2cm
        h1=plot(cntX, cntY, '+'); hold on;
        text(cntX+2, cntY, [num2str(floor(cntY/4/inch2cm)), ',' num2str(floor(cntX/4/inch2cm))]);
    end
end
axis equal;
axis([0 80 0 35]);
xlabel('x'); ylabel('y'); title('Indeices of positions used for error estimation.'); 

NumFrame=21;
M = moviein(NumFrame);
myview2=[-2 34 -2 18]*inch2cm;
for cnt=1:NumFrame
    ind=find(SampRate(cnt,:)>0);
    h4=plot(SenPosX,SenPosY,'o');
    hold on; axis equal; 
    axis(myview2);
    h5=plot(SenPosX(ind), SenPosY(ind),'*r');
    tmp=est{IndDat(cnt,1),IndDat(cnt,2)}(1,1:2);
    h1=plot(tmp(1), tmp(2), 'dc');
    tmp=est{IndDat(cnt,1),IndDat(cnt,2)}(2,1:2);
    h2=plot(tmp(1), tmp(2),'<k');
    tmp=mean(est{IndDat(cnt,1),IndDat(cnt,2)}(3:end,1:2),1);
    h3=plot(tmp(1), tmp(2),'>b');
    legend([h1,h2,h3,h4,h5],'Measured Pos.','A pri. Pos.','A post. Pos.','Sensor','Active Sensor');
    M(:,cnt)=getframe(gcf);
    xlabel('x (cm)');
    ylabel('y (cm)');    
    str=['SSHardwareMovieFrame', num2str(cnt), '.eps'];
    %     print('-deps2c', str);
    %     saveas(gcf, ['SSHardwareMovieFrame' , num2str(cnt)], 'mfig');
    clf;
end
movie(M);

% % % % save to AVI file
% aviobj = avifile('SSHardwareMovie.avi','fps',2);
% for cnt=1:NumFrame
%     aviobj = addframe(aviobj,M(:,cnt));
% end
% aviobj = close(aviobj);

